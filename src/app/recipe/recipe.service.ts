import { Recipe } from './recipe.model';
import { Ingredient } from '../shared/ingredient.model';
import { HttpHeaders, HttpClient } from '@angular/common/http';
import { Injectable, EventEmitter } from '@angular/core';
import { map } from 'rxjs/operators';

@Injectable()
export class RecipeService {
  recipesChanged = new EventEmitter<Recipe[]>()

  constructor(private httpClient: HttpClient){

  }
  private recipes: Recipe[] = [
    new Recipe(
      'Schnitzel',
      'Ein Sehr schönes Schnitzel',
      'https://www.thespruceeats.com/thmb/VYxi1MPOLh3W286dhp270ozcjrY=/960x0/filters:no_upscale():max_bytes(150000):strip_icc()/wiener-schnitzel-recipe-1447089-Hero-5b587d6c46e0fb0071b0059d.jpg',
      [
        new Ingredient('Pommes', 10),
        new Ingredient('Schnitzel', 1)
      ]
      ),
    new Recipe(
      'Salat',
      'Ein Sehr schöner Salat',
      'data:image/jpeg;base64,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',
      []
      ),
  ];

  getRecipes() {
    return this.recipes;
  }

  getRecipe(id: number) {
    return this.recipes[id];
  }

  deleteRecipe(id: number) {
    this.recipes.splice(id, 1);
  }

  addRecipe(recipe: Recipe) {
    this.recipes.push(recipe);
  }

  editRecipe(oldRecipe: Recipe, newRecipe: Recipe) {
    this.recipes[this.recipes.indexOf(oldRecipe)]= newRecipe;
  }

  storeData() {
    const body = JSON.stringify(this.recipes);
    const headers = new HttpHeaders({'Content-Type': 'application/json'});
    return this.httpClient.put('https://maxrezept-66da4.firebaseio.com/recipe.json', body, { headers });
  }

  fetchData() {
    // const recipes = this.httpClient.get('https://maxrezept-66da4.firebaseio.com/recipe.json').pipe(
    //   map((response: Response) => response)
    // );
    // // recipes.subscribe(response => console.log(response));
    // recipes.subscribe((response) => {
    //   this.recipes = response;
    // })

    this.httpClient.get<Recipe[]>('https://maxrezept-66da4.firebaseio.com/recipe.json').pipe(
      map((recipes) => recipes)
    ).subscribe(recipes => {
      this.recipes = recipes;
      this.recipesChanged.emit(this.recipes);
    });

    // recipes.subscribe(response => console.log(response));
  }
}
